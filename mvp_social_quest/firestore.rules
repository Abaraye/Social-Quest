rules_version = '2';
service cloud.firestore {
  function isAuth() {
    return request.auth != null;   // utilisateur connecté
  }

  match /databases/{database}/documents {

    /* ------------------------------------------------------------------
     * Règles minimales indispensables (ex. users = self-access uniquement)
     * ------------------------------------------------------------------ */
    match /users/{userId} {
      allow read, write: if isAuth() && request.auth.uid == userId;
    }

    /* ------------------------------------------------------------------
     * Fallback “open for MVP” : tout document, toute collection
     * ------------------------------------------------------------------ */
    match /{document=**} {
      allow read, write: if isAuth();
    }
  }
}
